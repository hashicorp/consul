---
layout: commands
page_title: 'Commands: Troubleshoot Proxy'
description: |
The `consul troubleshoot proxy` diagnoses Consul service mesh configuration and network issues to an upstream.
---

# Consul Troubleshoot Proxy

Command: `consul troubleshoot proxy`

## Usage

Usage: `consul troubleshoot proxy (-upstream-ip <ip>|-upstream-envoy-id <envoy-id>) [options]

#### Command Options

- `-envoy-admin-endpoint=<value>` - Envoy Admin endpoint address for the local Envoy instance.
Defaults to `127.0.0.1:19000`.

- `-upstream-ip=<value>` - The IP address of the upstream transparent proxy.

- `-upstream-envoy-id=<value>` - The Envoy identifier of the upstream service to be troubleshooted.

## Examples

Troubleshoot Consul service mesh configuration and network issues from the current Envoy instance.

```shell-session hideClipboard
$ consul troubleshoot proxy -upstream-ip 10.4.6.160

==> Validation
 ✓ certificates are valid
 ✓ Envoy has 0 rejected configurations
 ✓ Envoy has detected 0 connection failure(s)
 ✓ listener for upstream "backend" found
 ✓ route for upstream "backend" found
 ✓ cluster "backend.default.dc1.internal..consul" for upstream "backend" found
 ✓ healthy endpoints for cluster "backend.default.dc1.internal.e08fa6d6-e91e-dfe0-f6e1-ba097a828e31.consul" for upstream "backend" found
 ✓ cluster "backend2.default.dc1.internal..consul" for upstream "backend" found
 ! no healthy endpoints for cluster "backend2.default.dc1.internal.e08fa6d6-e91e-dfe0-f6e1-ba097a828e31.consul" for upstream "backend" found
```

Troubleshoot Consul service mesh configuration and network issues from the current Envoy instance to the given upstream Envoy identifier.

```shell-session
$ consul-k8s troubleshoot proxy -upstream-envoy-id db
```

```
==> Validation
 ✓ certificates are valid
 ✓ Envoy has 0 rejected configurations
 ✓ Envoy has detected 0 connection failure(s)
 ! no listener for upstream "db" found
 ! no route for upstream "backend" found
 ! no cluster "db.default.dc1.internal.e08fa6d6-e91e-dfe0-f6e1-ba097a828e31.consul" for upstream "db" found
 ! no healthy endpoints for cluster "db.default.dc1.internal.e08fa6d6-e91e-dfe0-f6e1-ba097a828e31.consul" for upstream "db" found
```
