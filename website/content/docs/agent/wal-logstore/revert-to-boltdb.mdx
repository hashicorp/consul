---
layout: docs
page_title: Revert to BoltDB
description: >-
  Learn how to revert Consul to the BoltDB backend after enabled the WAL (write-ahead log) LogStore backend shipped in Consul 1.15.
---

# Revert storage backend to BoltDB from WAL 

This topic describes revert your Consul storage backend from the experimental WAL LogStorage backend to the default BoltDB.

The overall process for reverting to BoltDB consists of the following steps. Repeat the steps for all Consul servers that you need to revrt.

1. Select target server.
1. Stop target server gracefully.
1. Remove data directory from target server.
1. Update target server's configuration.
1. Start target server.

## Select target server

If you are using Consul OSS or Consul Enterprise without non-voting servers, select one of the follower servers. As noted in [Risks](/consul/docs/agent/wal-logstore/enable#risks), Consul Enterprise users with non-voting servers should begin the procedure with a non-voting server.

Run the following command to retrieve the current state of the servers:

```shell-session
$ consul operator raft list-peers
```

## Stop target server gracefully

Stop the target server gracefully. For example, if you are using `systemcmd`, 
run the following command:

```shell-session
$ systemctl stop consul
```

If your environment uses configuration management automation that might interfere with this process, such as Chef or Puppet, you must disable them until you have completely revereted the storage backend.

## Remove data directory from target server

Temporarily moving the data directory to a different location is less destructive than deleting it. We recommend doing this in case you unsuccessfully enable WAL. Do not use the old data directory (`/data-dir/raft.bak`) for recovery after restarting the server. We recommend eventually deleting the old directory.

The following example moves the data atfrom `/data-dir` in the configuration file to `/temp/data-dir`.

```shell-session
$ mv /data-dir/raft /temp/data-dir/raft.bak
```

When switching backend, you must always remove the _whole raft directory_ not just the `raft.db` file or `wal` directory. This is because the log must always be consistent with the snapshots to avoid undefined behavior or data loss.

## Update target server's configuration

Modify the `backend` in the target server's configuration file:

```hcl
raft_logstore {
  backend = "boltdb"
  verification {
    enabled = true
    interval = "60s"
  }
}
```

## Start target server

Start the target server. For example, if you are using `systemcmd`, run the following command:

```shell-session
$ systemctl start consul
```

Watch for the server to become a healthy voter again.

```shell-session
$ consul operator raft list-peers
```

### Clean up old data directories

If necessary, cleanup any `raft.bak` directories. Replace `/data-dir` the value you have specified in your configuration file.

```shell-session
$ rm /data-dir/raft.bak
```