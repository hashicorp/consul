{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: BUSL-1.1
}}

<ListCollection
  class="consul-peer-list"
  ...attributes
  @items={{@items}}
  @linkable="linkable peers"
  as |item index|
>
  <BlockSlot @name="header">
    {{#if (can "delete peer" item=item)}}
      <a
        data-test-peer={{item.Name}}
        href={{href-to "dc.peers.show" item.Name}}
      >
        {{item.Name}}
      </a>
    {{else}}
      <p data-test-peer={{item.Name}}>
        {{item.Name}}
      </p>
    {{/if}}
  </BlockSlot>
  <BlockSlot @name="details">
    <div class="peers__list__peer-detail">
      <Peerings::Badge @peering={{item}} />

      <div
        {{tooltip
          (t "routes.dc.peers.index.detail.imported.tooltip" name=item.Name)
        }}
      >
        {{t
          "routes.dc.peers.index.detail.imported.count"
          count=(format-number item.ImportedServiceCount)
        }}
      </div>

      <div
        {{tooltip
          (t "routes.dc.peers.index.detail.exported.tooltip" name=item.Name)
        }}
      >
        {{t
          "routes.dc.peers.index.detail.exported.count"
          count=(format-number item.ExportedServiceCount)
        }}
      </div>

    </div>
  </BlockSlot>
  <BlockSlot @name="actions" as |Actions|>
    {{#if (can "delete peer" item=item)}}

      <Actions as |Action|>
        {{#if (and (can "write peer" item=item) item.isDialer)}}
          <Action data-test-regenerate-action {{on "click" (fn @onedit item)}}>
            <BlockSlot @name="label">
              Regenerate token
            </BlockSlot>
          </Action>
        {{/if}}
        <Action
          data-test-view-action
          @href={{href-to "dc.peers.show" item.Name}}
        >
          <BlockSlot @name="label">
            View
          </BlockSlot>
        </Action>
        <Action
          data-test-delete-action
          @onclick={{fn @ondelete item}}
          class="dangerous"
        >
          <BlockSlot @name="label">
            Delete
          </BlockSlot>
          <BlockSlot @name='confirm-header'>
            Confirm delete
          </BlockSlot>
          <BlockSlot @name='confirm-body'>
            <p>
              Are you sure you want to delete this peer?
            </p>
          </BlockSlot>
          <BlockSlot @name='confirm-footer' as |Params|>
            <Params.button @text='Delete' {{on 'click' Params.confirmAction}} />
          </BlockSlot>
        </Action>
      </Actions>
    {{/if}}
  </BlockSlot>
</ListCollection>