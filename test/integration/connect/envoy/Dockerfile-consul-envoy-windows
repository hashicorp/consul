# Note this arg has to be before the first FROM
ARG ENVOY_VERSION=1.22.1

FROM windows/consul-dev as consul

FROM docker.mirror.hashicorp.services/windows/envoy-windows:v${ENVOY_VERSION}
COPY --from=consul C:\\consul C:\\consul

EXPOSE 8300
EXPOSE 8301 8301/udp 8302 8302/udp
EXPOSE 8500 8600 8600/udp
EXPOSE 8502 
EXPOSE 19000
EXPOSE 21000

ENV PATH C:\\consul;C:\\Program Files\\envoy;C:\\Windows\\System32;%PATH%;